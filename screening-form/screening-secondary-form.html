<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="../../iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../../iron-icons/iron-icons.html">
<link rel="import" href="../../iron-validatable-behavior/iron-validatable-behavior.html">
<link rel="import" href="../../paper-styles/typography.html">
<link rel="import" href="../../paper-radio-group/paper-radio-group.html">
<link rel="import" href="../../paper-radio-button/paper-radio-button.html">
<link rel="import" href="../../paper-checkbox/paper-checkbox.html">
<link rel="import" href="../../paper-input/paper-input.html">
<link rel="import" href="../form-control.html">
<link rel="import" href="../studentcare-form-behavior.html">

<link href="https://fonts.googleapis.com/css?family=Itim&amp;subset=thai" rel="stylesheet">

<dom-module id="screening-secondary-form">
  <template>
    <style include="iron-flex iron-flex-alignment iron-flex-factors">

      :host {
        @apply --paper-font-display;
        @apply --layout-vertical;
        display: block;
      }

      .invalid {
        border: 1px solid #ee0000;
      }

      .formEntry div {
        @apply --paper-font-display;
        margin:3px;
        padding:0px;
      }

      .evaluation {
        padding:5px;
      }
      
      .sub-question {
        padding-left:20px;
      }

      .topic1 {
        padding:20px;
        margin-right:20px;
        @apply --layout-vertical;
      }
      
      .topic1 paper-input {
        /*font-family: 'Itim', cursive;
         font-size: 120%;*/
        margin-left:50px;
        
      }

      .topic1 paper-checkbox {
        margin-top:10px;
      }

      .check-icon {
        width:30px;
      }
     
      .font-face-normal {
        font-family: 'Itim', cursive;
        font-size: 120%;
      }
      .font-face-normal {
        font-family: 'Itim', cursive;
        font-size: 120%;
      }
      .font-face-bolder {
        font-family: 'Itim', cursive;
        font-size: 120%;
        font-weight: bold;
      }

      .flex-1{
        font-family: 'Itim', cursive;
        font-size: 120%;
      }
      label{
        font-family: 'Itim', cursive;
        font-size: 120%;
      }
      .headQ{
        font-weight: bold;
        font-size: 120%;
      }
      /*.label2{
 font-family: 'Itim', cursive;
        font-size: 120%;
      }*/

     #res {
      --paper-input-container-input: {
        /*font-size: 24px;*/
        font-family: 'Itim', cursive;
      };
      --paper-input-container-label:{
        font-family: 'Itim', cursive;
      };
      --paper-input-container-focus-color:#F44336; 
     }

    </style>

    <form-control id="control" 
      on-form-action="_tap" 
      doc-key="{{document.key}}"
      doc-value="{{document.value}}">
      <div slot="description">
        <ol class="num"><b class="font-face-bolder"> คำชี้แจง</b>
         <li class="font-face-normal">ให้เลือกว่าอาการในแต่ละข้อนั้นตรงกับลักษณะของเด็กที่ท่านประเมินเพียงใด</li>
        </ol>
      </div>
      <div slot="formEntry">
       <ol>
         <li>
           <label id="label1" class="headQ">ความสามารถพิเศษ (ความถนัดและความสนใจในวิชาที่เรียน)</label>
           <paper-radio-group aria-labelledby="label1" selected="{{document.value.form_value.q1}}">
             <paper-radio-button name="y" class ="font-face-normal" >มี</paper-radio-button>
             <paper-radio-button name="n"class ="font-face-normal">ไม่มี</paper-radio-button>
           </paper-radio-group>
           <div class="topic1" hidden$="{{!_isEquals(document.value.form_value.q1,'y')}}">

             <paper-checkbox checked="{{document.value.form_value.q1_1}}">
              <div class="font-face-normal">กลุ่มสาระการเรียนรู้คณิตศาสตร์</div>
             </paper-checkbox>
             <paper-input id ="res" value="{{document.value.form_value.q1_1_t1}}" 
               label="ลำดับที่ 1"
               disabled="{{!document.value.form_value.q1_1}}">
             </paper-input>
             <paper-input id ="res" value="{{document.value.form_value.q1_1_t2}}"
               label="ลำดับที่ 2"
               disabled="{{!document.value.form_value.q1_1}}">
             </paper-input>

             <paper-checkbox checked="{{document.value.form_value.q1_2}}">
             <div class="font-face-normal">กลุ่มสาระการเรียนรู้ภาษาไทย</div>
             </paper-checkbox>
             <paper-input id ="res" value="{{document.value.form_value.q1_2_t1}}" 
               label="ลำดับที่ 1"
               disabled="{{!document.value.form_value.q1_2}}">
             </paper-input>
             <paper-input id ="res" value="{{document.value.form_value.q1_2_t2}}"
               label="ลำดับที่ 2"
               disabled="{{!document.value.form_value.q1_2}}">
             </paper-input>

             <paper-checkbox checked="{{document.value.form_value.q1_3}}">
             <div class="font-face-normal">กลุ่มสาระการเรียนรู้ภาษาต่างประเทศ</div>
             </paper-checkbox>
             <paper-input id ="res" value="{{document.value.form_value.q1_3_t1}}" 
               label="ลำดับที่ 1"
               disabled="{{!document.value.form_value.q1_3}}">
             </paper-input>
             <paper-input id ="res" value="{{document.value.form_value.q1_3_t2}}"
               label="ลำดับที่ 2"
               disabled="{{!document.value.form_value.q1_3}}">
             </paper-input>

             <paper-checkbox checked="{{document.value.form_value.q1_4}}">
             <div class="font-face-normal">กลุ่มสาระการเรียนรู้วิทยาศาสตร์</div>
             </paper-checkbox>
             <paper-input id ="res" value="{{document.value.form_value.q1_4_t1}}" 
               label="ลำดับที่ 1"
               disabled="{{!document.value.form_value.q1_4}}">
             </paper-input>
             <paper-input id ="res" value="{{document.value.form_value.q1_4_t2}}"
               label="ลำดับที่ 2"
               disabled="{{!document.value.form_value.q1_4}}">
             </paper-input>

             <paper-checkbox checked="{{document.value.form_value.q1_5}}">
             <div class="font-face-normal">กลุ่มสาระการเรียนรู้ศิลปะ</div>
             </paper-checkbox>
             <paper-input id ="res" value="{{document.value.form_value.q1_5_t1}}" 
               label="ลำดับที่ 1"
               disabled="{{!document.value.form_value.q1_5}}">
             </paper-input>
             <paper-input id ="res" value="{{document.value.form_value.q1_5_t2}}"
               label="ลำดับที่ 2"
               disabled="{{!document.value.form_value.q1_5}}">
             </paper-input>

             <paper-checkbox checked="{{document.value.form_value.q1_6}}">
             <div class="font-face-normal">กลุ่มสาระการเรียนรู้การงานอาชีพและเทคโนโลยี</div>
             </paper-checkbox>
             <paper-input id ="res" value="{{document.value.form_value.q1_6_t1}}" 
               label="ลำดับที่ 1"
               disabled="{{!document.value.form_value.q1_6}}">
             </paper-input>
             <paper-input id ="res" value="{{document.value.form_value.q1_6_t2}}"
               label="ลำดับที่ 2"
               disabled="{{!document.value.form_value.q1_6}}">
             </paper-input>

             <paper-checkbox checked="{{document.value.form_value.q1_7}}">
             <div class="font-face-normal">กลุ่มสาระการเรียนรู้สุขศึกษาและพลศึกษา</div>
             </paper-checkbox>
             <paper-input id ="res" value="{{document.value.form_value.q1_7_t1}}" 
               label="ลำดับที่ 1"
               disabled="{{!document.value.form_value.q1_7}}">
             </paper-input>
             <paper-input id ="res" value="{{document.value.form_value.q1_7_t2}}"
               label="ลำดับที่ 2"
               disabled="{{!document.value.form_value.q1_7}}">
             </paper-input>

             <paper-checkbox checked="{{document.value.form_value.q1_8}}">
             <div class="font-face-normal">กลุ่มสาระการเรียนรู้สังคมศึกษา ศาสนา และวัฒนธรรม</div>
             </paper-checkbox>
             <paper-input id ="res" value="{{document.value.form_value.q1_8_t1}}" 
               label="ลำดับที่ 1"
               disabled="{{!document.value.form_value.q1_8}}">
             </paper-input>
             <paper-input id ="res" value="{{document.value.form_value.q1_8_t2}}"
               label="ลำดับที่ 2"
               disabled="{{!document.value.form_value.q1_8}}">
             </paper-input>

             <paper-checkbox checked="{{document.value.form_value.q1_9}}">
            <div class="font-face-normal"> อื่น ๆ</div>
             </paper-checkbox>
             <paper-input id ="res" value="{{document.value.form_value.q1_9_t1}}" 
               label="ลำดับที่ 1"
               disabled="{{!document.value.form_value.q1_9}}">
             </paper-input>
             <paper-input id ="res" value="{{document.value.form_value.q1_9_t2}}"
               label="ลำดับที่ 2"
               disabled="{{!document.value.form_value.q1_9}}">
             </paper-input>

           </div>
         </li>
         <li>
           <label id="label2"  class="headQ">ด้านการเรียน</label>
           <paper-input id ="res"  label="ผลการประเมิน" readonly 
             value="{{_q2Text(document.value.form_value.q2)}}"> 
           </paper-input>
           <div class="layout horizontal"><!-- หัวตาราง -->
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q2_1_m}}">
               ผลการเรียนเฉลี่ย 1.00 - 2.00
             </paper-checkbox>
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q2_1_p}}">
               ผลการเรียนเฉลี่ยต่ำกว่า 1.00 
             </paper-checkbox>
           </div>
           <div class="layout horizontal">
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q2_2_m}}"><!-- M ซ้าย -->
               ติด 0, ร, มส, มผ 1-2 วิชา ต่อ 1 ภาคเรียน
             </paper-checkbox>
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q2_2_p}}"><!-- P ขวา -->
               ติด 0, ร, มส, มผ มากกว่า 2 วิชา ต่อ 1 ภาคเรียน
             </paper-checkbox>
           </div>
           <div class="layout horizontal">
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q2_3_m}}">
               ไม่เขัาเรียน 1-2 ครั้ง ต่อ รายวิชา
             </paper-checkbox>
           </div>
           <div class="layout horizontal">
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q2_4_m}}">
               มาเรียนสาย 3 ครั้งต่อสัปดาห์
             </paper-checkbox>
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q2_4_p}}">
               มาเรียนสายมากกว่า 3 ครั้งต่อสัปดาห์
             </paper-checkbox>
           </div>
           <div class="layout horizontal">
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q2_5_m}}">
               ไม่ตั้งใจเรียนขณะครูสอน
             </paper-checkbox>
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q2_5_p}}">
               ไม่เข้าเรียนหลายครั้งโดยไม่มีเหตุจำเป็น
             </paper-checkbox>
           </div>
           <div class="layout horizontal">
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q2_6_m}}">
               ไม่มีอุปกรณ์การเรียนมาเรียนหรือนำอุปกรณ์การเรียนมาไม่ครบ 
             </paper-checkbox>
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q2_6_p}}">
               สมาธิสั้น
             </paper-checkbox>
           </div>
           <div class="layout horizontal">
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q2_7_m}}">
                อ่านสะกดคำไม่ได้
             </paper-checkbox>
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q2_7_p}}">
                ขาดเรียนบ่อยมากกว่า 1 วันต่อสัปดาห์
             </paper-checkbox>
           </div>
           <div class="layout horizontal">
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q2_8_m}}">
                 จับใจความสำคัญไม่ได้
             </paper-checkbox>
           </div>
           <div class="layout horizontal">
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q2_9_m}}">
                 เขียนตัวอักษรไม่ได้
             </paper-checkbox>
           </div>
           <div class="layout horizontal">
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q2_10_m}}">
                อ่านไม่ได้ใจความ
             </paper-checkbox>
           </div>
           <div class="layout horizontal">
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q2_11_m}}">
                ไม่ส่งงาน 1-2 วิชา
             </paper-checkbox>
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q2_11_p}}">
               ไม่ส่งงานมากกว่า 2 วิชา
             </paper-checkbox>
           </div>
           <div class="layout horizontal">
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q2_12_m}}">
                ไม่ผ่านคุณลักษณะอันพึงประสงค์ 1 ข้อ
             </paper-checkbox>
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q2_12_p}}">
               ไม่ผ่านคุณลักษณะอันพึงประสงค์ตั้งแต่ 2 ข้อขึ้นไป
             </paper-checkbox>
           </div>
           <div class="layout horizontal">
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q2_13_m}}">
                ผลการประเมินการอ่านคิดวิเคราะห์และเขียนสื่อความอยู่ในระดับ 1
             </paper-checkbox>
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q2_13_p}}">
                ผลการประเมินการอ่านคิดวิเคราะห์และเขียนสื่อความไม่ผ่าน
             </paper-checkbox>
           </div>
         </li>
         <li>
           <label id="label2"  class="headQ">ด้านสุขภาพ</label>
           <paper-input id ="res" label="ผลการประเมิน" readonly 
             value=""> 
           </paper-input>
            <div class="layout horizontal">
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q3_1_m}}">
                น้ำหนักผิดปกติ  และไม่สัมพันธ์กับส่วนสูง  หรืออายุ
             </paper-checkbox>
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q3_1_p}}">
                ป่วยเป็นโรคหรือมีความพิการทางร่างกายมีความบกพร่องทางการได้ยินการมองเห็น  และความเจ็บป่วย  หรือบกพร่องดังกล่าวมีผลกระทบต่อความสามารถด้านการเรียนในระดับมีปัญหา
             </paper-checkbox>
           </div>
           <div class="layout horizontal">
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q3_2_m}}">
                มีโรงประจำตัวหรือเจ็บป่วยบ่อยๆ
             </paper-checkbox>
           </div>
            <div class="layout horizontal">
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q3_3_m}}">
                มีความพิการทางร่างกายหรือบกพร่องด้านการยิน การฟัง การมองเห็น  หรืออื่นๆ
             </paper-checkbox>
           </div>
           <div class="layout horizontal">
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q3_4_m}}">
                ให้นักเรียนพิจารณาใช้แบบประเมินพฤติกรรมหรือเครื่องมืออื่นๆ ตามความเหมาะสมกับสภาพโรงเรียน
             </paper-checkbox>
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q3_4_p}}">
                ให้นักเรียนพิจารณาใช้แบบประเมินพฤติกรรมหรือเครื่องมืออื่นๆ ตามความเหมาะสมกับสภาพโรงเรียน
             </paper-checkbox>
           </div>

         </li>
         <li>
           <label id="label2"  class="headQ">ด้านพฤติกรรม</label>
           <paper-input id ="res" label="ผลการประเมิน" readonly 
             value=""> 
           </paper-input>
            <div class="layout horizontal">
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q4_1_m}}">
                มีพฤติกรรมแสดงออกดังนี้<br>
                1.	ความเฉี่อยชา<br>
                2.	ชอบเก็บตัว<br>
                3.	การลักขโมย<br>
                4.	การโกหก<br>
                ฯลฯ<br>
                ซึ่งเป็นพฤติกรรมที่แสดงออกเป็นครั้งคราว

             </paper-checkbox>
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q4_1_p}}">
                มีพฤติกรรมแสดงออกดังนี้<br>
                1.	ความก้าวร้าว<br>
                2.	หนีโรงเรียน<br>
                3.	ชอบรังแกคนอื่น/สัตว์<br>
                4.	การใช้สารเสพติด<br>
                ฯลฯ<br>
                ซึ่งเป็นพฤติกรรมที่แสดงออกเป็นประจำ

             </paper-checkbox>
           </div>
         </li>
                  <li>
           <label id="label2"  class="headQ">ด้านอื่นๆ</label>
           <paper-input id ="res" label="ผลการประเมิน" readonly 
             value=""> 
           </paper-input>
            <div class="layout horizontal">
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q5_1_m}}">
                มีการทดลองดื่มเบียร์ สุรา หรือสูบบุหรี่โดยตนเองหรือเพื่อนชักชวน
             </paper-checkbox>
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q5_1_p}}">
                ใช้ยาเสพติด  สารเสพติด ดื่มเบียร์  สุรา  หรือสูบบุหรี่เป็นครั้งคราวและมีแนวโน้นว่าจะเพิ่มขึ้นและเป็นผู้ชวนให้ผู้อื่นปฏิบัติตาม
             </paper-checkbox>
           </div>
            <div class="layout horizontal">
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q5_2_m}}">
                ติดเพื่อนต่างเพศแนวชู้สาว
             </paper-checkbox>
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q5_2_p}}">
                ติดต่อเพื่อนต่างเพศในแนวชู้สาว  หรือถึงขั้นมีความสัมพันธ์ทางเพศ
             </paper-checkbox>
           </div>
           <div class="layout horizontal">
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q5_3_m}}">
                จับคู่ชัดเจนและแยกอยู่กันสองต่อสองบ่อยๆ
             </paper-checkbox>

           </div>
           <div class="layout horizontal">
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q5_3_m}}">
                มีพฤติกรรมเบี่ยงเบนทางเพศ  จนมีผลต่อการเรียน
             </paper-checkbox>
    
           </div>
         </li>
                  <li>
           <label id="label2"  class="headQ">ด้านสังคม</label>
           <paper-input id ="res" label="ผลการประเมิน" readonly 
             value=""> 
           </paper-input>
            <div class="layout horizontal">
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q6_1_m}}">
                สามารถปรับตัวได้ในบางเรื่องบางกรณี  และมักปฏิบัติตนขัดแย้งกับกฎเกณฑ์ต่างๆของโรงเรียน  ห้องเรียนเมื่อได้รับการตักเตือนก็เลิกพฤติกรรมนั้นได้
             </paper-checkbox>
             <paper-checkbox class="flex-1" checked="{{document.value.form_value.q6_1_p}}">
                สามารถปรับตัวได้ในบางกรณี  แต่มีข้อขัดแย้งสม่ำเสมอ ก่อปัญหาให้แก้ไข  อยู่เสมอ  เมื่อได้รับการตักเตือนก็ไม่หยุดพฤติกรรมต่อด้าน
             </paper-checkbox>
           </div>
         </li>
       </ol>
     </div>

     <div slot="evaluation">
      <!--
      <div class="layout vertical">
       <div class="layout horizontal">
        <div class="check-icon">
          <iron-icon icon="check" hidden$="{{!_mark}}">
          </iron-icon>
        </div>
        <span class="flex" id="markPositive">
          พบความบกพร่อง
        </span>
       </div>
       <div class="layout horizontal">
        <div class="check-icon">
          <iron-icon icon="check" hidden$="{{_mark}}">
          </iron-icon>
        </div>
        <span class="flex" id="markNegative">
          ไม่พบความบกพร่อง
        </span>
       </div>
      </div>
      -->
      <div class="font-face-normal">ไม่มีหลักเกณฑ์</div>
     </div>
    </form-control>

  </template>

  <script>
    Polymer({
      is: 'screening-secondary-form',
      listeners : {
      },
      properties: {
        name: {
          type:String,
          reflectToAttribute:true,
          value:"แบบคัดกรองนักเรียนรายบุคคล ระดับมัธยม"
        }
      },
      behaviors:[
        Polymer.IronValidatableBehavior,
        StudentcareFormBehavior,
      ],
      observers:[
        '_result(document.value.form_result)',
        '_monitor(document.value.form_value.*)',
      ],
      _tap:function(e) {
        if(e.detail.type == "save") {
          this.$.control.save();
        }
      },
      _q2Text:function(q2) {
        if(q2=='p') {
          return 'มีปัญหา';
        } else {
          if(q2=='m') {
            return 'เสี่ยง';
          }
        }
      },
      _monitor:function(changeRecord) {
        if(!this.document.value) return;
        var tmp = this.document.value.form_value;
        var current_max = '';
        for(var q in tmp) { 
          var qs = q.split('_');
          if(qs[0] =='q2' && tmp[q]) {
            if(qs[2] == 'p') { 
              current_max = 'p';
            } else {
              if(current_max != 'p') {
                current_max = qs[2];
              }
            }
          }
        }
        this.set('document.value.form_value.q2',current_max);
      },
      _evaluate:function() {
        var values = this.document.value.form_value;
        var score = {};
        for(var q in values) {
          var p = q.split('_')[0];
          if(!score[p]) score[p] = {'y':0,'n':0};
          score[p][values[q]]++;
        }
        return score;
      },
      _validate:function() {
        var eles =Polymer.dom(this.root)
         .querySelectorAll('snap-choice');
        for(var i=0;i<eles.length;i++) {
          if(!eles[i].value)  {
            console.log(eles[i]);
            eles[i].classList.add('invalid');
            return false;
          } else {
            eles[i].classList.remove('invalid');
          }
        }
        return true;
      },
      _isEquals:function(a,b) {
        return a != null && a == b ;
      },
      _reset:function() {
        this.set('document.value.form_value',{});        
      },
      _result:function(score) {
        /*
        if(!score) return;
        var foundSub = false; 
        for(var key in score) {
          if(key.indexOf('s') == 0 && score[key].y>=2) {
            foundSub=true;
            break;
          }
        }
        if(score.p1.y >= 1  && foundSub) {
          this.$$('#markPositive').classList.add('mark');
          this.$$('#markNegative').classList.remove('mark');
          this.set('_mark',true);
        } else {
          this.$$('#markNegative').classList.add('mark');
          this.$$('#markPositive').classList.remove('mark');
          this.set('_mark',false);
        }
        */
      }
    });
  </script>
</dom-module>
